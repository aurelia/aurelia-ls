[
  {
    "name": "R-D-02 repeat with unknown tail option surfaces AU1106",
    "markup": "<ul repeat.for=\"item of items; bogus: true\"></ul>",
    "expect": {
      "items": [
        { "kind": "iterator", "res": "repeat", "to": "items" }
      ],
      "diags": [
        { "code": "AU1106" }
      ]
    }
  },
  {
    "name": "R-D-10 [else] without preceding [if] surfaces AU0810",
    "markup": "<div else>orphan else</div>",
    "expect": {
      "items": [],
      "diags": [
        { "code": "AU0810" }
      ]
    }
  },
  {
    "name": "R-D-11 [else] after non-if sibling surfaces AU0810",
    "markup": "<div repeat.for=\"i of items\">loop</div><div else>wrong parent</div>",
    "expect": {
      "items": [
        { "kind": "iterator", "res": "repeat", "to": "items" }
      ],
      "diags": [
        { "code": "AU0810" }
      ]
    }
  },
  {
    "name": "R-D-12 valid [if]/[else] pair has no diagnostics",
    "markup": "<div if.bind=\"x\">yes</div><div else>no</div>",
    "expect": {
      "items": [
        { "kind": "ctrlProp", "res": "if", "to": "value", "target": "controller", "effectiveMode": "default" }
      ],
      "diags": []
    }
  },
  {
    "name": "R-D-13 valid [promise]/[then]/[catch] has no diagnostics",
    "markup": "<div promise.bind=\"p\"><template then>resolved</template><template catch>error</template></div>",
    "expect": {
      "items": [
        { "kind": "ctrlProp", "res": "promise", "to": "value", "target": "controller", "effectiveMode": "default" },
        { "kind": "ctrlProp", "res": "then", "to": "value", "target": "controller", "effectiveMode": "toView" },
        { "kind": "branch", "res": "then", "branch": "then" },
        { "kind": "ctrlProp", "res": "catch", "to": "value", "target": "controller", "effectiveMode": "toView" },
        { "kind": "branch", "res": "catch", "branch": "catch" }
      ],
      "diags": []
    }
  },
  {
    "name": "R-D-14 [case] without parent [switch] surfaces AU0815",
    "markup": "<template case.bind=\"x\">orphan case</template>",
    "expect": {
      "items": [
        { "kind": "ctrlProp", "res": "case", "to": "value", "target": "controller", "effectiveMode": "default" }
      ],
      "diags": [
        { "code": "AU0815" }
      ]
    }
  },
  {
    "name": "R-D-15 [default-case] without parent [switch] surfaces AU0815",
    "markup": "<template default-case>orphan default</template>",
    "expect": {
      "items": [],
      "diags": [
        { "code": "AU0815" }
      ]
    }
  },
  {
    "name": "R-D-16 valid [switch]/[case]/[default-case] has no diagnostics",
    "markup": "<div switch.bind=\"x\"><template case.bind=\"1\">one</template><template default-case>other</template></div>",
    "expect": {
      "items": [
        { "kind": "ctrlProp", "res": "switch", "to": "value", "target": "controller", "effectiveMode": "default" },
        { "kind": "ctrlProp", "res": "case", "to": "value", "target": "controller", "effectiveMode": "default" }
      ],
      "diags": []
    }
  },
  {
    "name": "R-D-17 multiple [default-case] in same switch surfaces AU0816",
    "markup": "<div switch.bind=\"x\"><template default-case>one</template><template default-case>two</template></div>",
    "expect": {
      "items": [
        { "kind": "ctrlProp", "res": "switch", "to": "value", "target": "controller", "effectiveMode": "default" }
      ],
      "diags": [
        { "code": "AU0816" }
      ]
    }
  },
  {
    "name": "R-D-20 unknown binding behavior surfaces AU0101",
    "markup": "<div textcontent.bind=\"value & unknownBehavior\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": [
        { "code": "AU0101" }
      ]
    }
  },
  {
    "name": "R-D-21 duplicate binding behavior surfaces AU0102",
    "markup": "<div textcontent.bind=\"value & debounce & debounce\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": [
        { "code": "AU0102" }
      ]
    }
  },
  {
    "name": "R-D-22 unknown value converter surfaces AU0103",
    "markup": "<div textcontent.bind=\"value | unknownConverter\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": [
        { "code": "AU0103" }
      ]
    }
  },
  {
    "name": "R-D-23 registered binding behavior has no diagnostic",
    "markup": "<div textcontent.bind=\"value & debounce\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": []
    }
  },
  {
    "name": "R-D-24 registered value converter has no diagnostic",
    "markup": "<div textcontent.bind=\"value | sanitize\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": []
    }
  },
  {
    "name": "R-D-25 multiple different non-conflicting behaviors allowed",
    "markup": "<div textcontent.bind=\"value & debounce & signal\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": []
    }
  },
  {
    "name": "R-D-26 conflicting rate-limiters (debounce + throttle) surfaces AU9996",
    "markup": "<div textcontent.bind=\"value & debounce & throttle\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": [
        { "code": "AU9996" }
      ]
    }
  },
  {
    "name": "R-D-27 conflicting rate-limiters (throttle + debounce) surfaces AU9996",
    "markup": "<div textcontent.bind=\"value & throttle & debounce\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": [
        { "code": "AU9996" }
      ]
    }
  },
  {
    "name": "R-D-28 single rate-limiter (debounce only) has no diagnostic",
    "markup": "<div textcontent.bind=\"value & debounce\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": []
    }
  },
  {
    "name": "R-D-29 single rate-limiter (throttle only) has no diagnostic",
    "markup": "<div textcontent.bind=\"value & throttle\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": []
    }
  },
  {
    "name": "R-D-30 assignment to $host surfaces AU0106",
    "markup": "<div au-slot textcontent.bind=\"$host = newValue\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": [
        { "code": "AU0106" }
      ]
    }
  },
  {
    "name": "R-D-31 assignment to $host.prop surfaces AU0106",
    "markup": "<div au-slot textcontent.bind=\"$host.value = newValue\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": [
        { "code": "AU0106" }
      ]
    }
  },
  {
    "name": "R-D-32 reading $host has no diagnostic",
    "markup": "<div au-slot textcontent.bind=\"$host.value\"></div>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "textContent", "target": "native", "effectiveMode": "toView" }
      ],
      "diags": []
    }
  }
]
