[
  {
    "name": "MB-01 multi-binding with two literals",
    "markup": "<a load=\"route: home; attribute: data-route\"></a>",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "home" },
        { "kind": "setProp", "to": "attribute", "value": "data-route" }
      ]
    }
  },
  {
    "name": "MB-02 multi-binding with .bind command",
    "markup": "<a load=\"route.bind: currentRoute; params.bind: routeParams\"></a>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "route", "target": "bindable", "effectiveMode": "toView" },
        { "kind": "prop", "to": "params", "target": "bindable", "effectiveMode": "toView" }
      ]
    }
  },
  {
    "name": "MB-03 multi-binding mixed literal and binding",
    "markup": "<a load=\"route: products; params.bind: data\"></a>",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "products" },
        { "kind": "prop", "to": "params", "target": "bindable", "effectiveMode": "toView" }
      ]
    }
  },
  {
    "name": "MB-04 multi-binding with interpolation",
    "markup": "<a load=\"route: products/${id}; attribute: href\"></a>",
    "expect": {
      "items": [
        { "kind": "attr", "attr": "route", "to": "route", "target": "bindable" },
        { "kind": "setProp", "to": "attribute", "value": "href" }
      ]
    }
  },
  {
    "name": "MB-05 noMultiBindings prevents multi-binding (href URL)",
    "markup": "<a href=\"https://example.com:8080/path\">Link</a>",
    "comment": "href has noMultiBindings=true, colon in URL is not parsed as multi-binding",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "value", "value": "https://example.com:8080/path" }
      ]
    }
  },
  {
    "name": "MB-06 interpolation before colon prevents multi-binding",
    "markup": "<a load=\"${routeExpr}\"></a>",
    "comment": "${ before any : means it's primary bindable interpolation",
    "expect": {
      "items": [
        { "kind": "attr", "attr": "load", "to": "route", "target": "bindable" }
      ]
    }
  },
  {
    "name": "MB-07 binding command on attr prevents multi-binding",
    "markup": "<a load.bind=\"routeConfig\"></a>",
    "comment": ".bind on the attribute itself means single binding to primary",
    "expect": {
      "items": [
        { "kind": "prop", "to": "route", "target": "bindable", "effectiveMode": "toView" }
      ]
    }
  },
  {
    "name": "MB-08 multi-binding with .two-way",
    "markup": "<a load=\"route: home; active.two-way: isActive\"></a>",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "home" },
        { "kind": "prop", "to": "active", "target": "bindable", "effectiveMode": "twoWay" }
      ]
    }
  },
  {
    "name": "MB-09 multi-binding with whitespace variations",
    "markup": "<a load=\"  route  :  home  ;  params.bind  :  data  \"></a>",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "home" },
        { "kind": "prop", "to": "params", "target": "bindable", "effectiveMode": "toView" }
      ]
    }
  },
  {
    "name": "MB-10 multi-binding three properties",
    "markup": "<a load=\"route: user; params.bind: userData; context.bind: ctx\"></a>",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "user" },
        { "kind": "prop", "to": "params", "target": "bindable", "effectiveMode": "toView" },
        { "kind": "prop", "to": "context", "target": "bindable", "effectiveMode": "toView" }
      ]
    }
  },
  {
    "name": "MB-11 trailing semicolon is valid",
    "markup": "<a load=\"route: home; params.bind: data;\"></a>",
    "comment": "Trailing semicolon should be handled gracefully",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "home" },
        { "kind": "prop", "to": "params", "target": "bindable", "effectiveMode": "toView" }
      ]
    }
  },
  {
    "name": "MB-12 single property with colon syntax",
    "markup": "<a load=\"route: home\"></a>",
    "comment": "Even single property can use colon syntax",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "home" }
      ]
    }
  },
  {
    "name": "MB-13 object literal in binding value",
    "markup": "<a load=\"route: home; params.bind: {id: 1, name: 'test'}\"></a>",
    "comment": "Object literal with colons inside value should work",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "home" },
        { "kind": "prop", "to": "params", "target": "bindable", "effectiveMode": "toView" }
      ]
    }
  },
  {
    "name": "MB-14 unknown bindable in multi-binding silently ignored",
    "markup": "<a load=\"route: home; unknownProp: value\"></a>",
    "comment": "Unknown bindables are ignored at lower phase, diagnostics in resolve phase",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "home" }
      ]
    }
  },
  {
    "name": "MB-15 value converter with colon in primary binding",
    "markup": "<a load.bind=\"route | format: 'prefix'\"></a>",
    "comment": ".bind command means single binding, colon in VC arg is not multi-binding",
    "expect": {
      "items": [
        { "kind": "prop", "to": "route", "target": "bindable", "effectiveMode": "toView" }
      ],
      "diags": [
        { "code": "AU0103" }
      ]
    }
  },
  {
    "name": "MB-16 interpolation before colon in value",
    "markup": "<a load=\"${prefix}: suffix\"></a>",
    "comment": "Interpolation starts before colon, treated as primary bindable",
    "expect": {
      "items": [
        { "kind": "attr", "attr": "load", "to": "route", "target": "bindable" }
      ]
    }
  },
  {
    "name": "MB-17 empty value in multi-binding",
    "markup": "<a load=\"route: ; params.bind: data\"></a>",
    "comment": "Empty literal value for route",
    "expect": {
      "items": [
        { "kind": "prop", "to": "params", "target": "bindable", "effectiveMode": "toView" }
      ]
    }
  },
  {
    "name": "MB-18 .from-view in multi-binding",
    "markup": "<a load=\"route: home; active.from-view: isActive\"></a>",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "home" },
        { "kind": "prop", "to": "active", "target": "bindable", "effectiveMode": "fromView" }
      ]
    }
  },
  {
    "name": "MB-19 .one-time in multi-binding",
    "markup": "<a load=\"route.one-time: initialRoute; params.bind: data\"></a>",
    "expect": {
      "items": [
        { "kind": "prop", "to": "route", "target": "bindable", "effectiveMode": "oneTime" },
        { "kind": "prop", "to": "params", "target": "bindable", "effectiveMode": "toView" }
      ]
    }
  },
  {
    "name": "MB-20 all properties with interpolation",
    "markup": "<a load=\"route: ${r}; attribute: ${a}\"></a>",
    "expect": {
      "items": [
        { "kind": "attr", "attr": "route", "to": "route", "target": "bindable" },
        { "kind": "attr", "attr": "attribute", "to": "attribute", "target": "bindable" }
      ]
    }
  },
  {
    "name": "MB-21 noMultiBindings with mailto URL",
    "markup": "<a href=\"mailto:test@example.com\">Email</a>",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "value", "value": "mailto:test@example.com" }
      ]
    }
  },
  {
    "name": "MB-22 noMultiBindings with data URL",
    "markup": "<a href=\"data:text/plain;base64,SGVsbG8=\">Data</a>",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "value", "value": "data:text/plain;base64,SGVsbG8=" }
      ]
    }
  },
  {
    "name": "MB-23 complex interpolation in multi-binding",
    "markup": "<a load=\"route: products/${category}/${id}; attribute: data-route\"></a>",
    "expect": {
      "items": [
        { "kind": "attr", "attr": "route", "to": "route", "target": "bindable" },
        { "kind": "setProp", "to": "attribute", "value": "data-route" }
      ]
    }
  },
  {
    "name": "MB-24 value with semicolon-like content (time format)",
    "markup": "<a load=\"route: schedule; attribute: 10:30\"></a>",
    "comment": "10:30 looks like time but is just a literal value for attribute",
    "expect": {
      "items": [
        { "kind": "setProp", "to": "route", "value": "schedule" },
        { "kind": "setProp", "to": "attribute", "value": "10:30" }
      ]
    }
  }
]
