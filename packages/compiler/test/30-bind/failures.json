[
  {
    "file": "bind-basic.json",
    "name": "B-05 portal reuses scope: inner binding remains in root",
    "markup": "<div portal><span title.bind=\"a\"></span></div>",
    "expected": {
      "frames": [
        {
          "label": "root",
          "parent": null,
          "kind": "root",
          "overlay": null,
          "origin": null
        }
      ],
      "locals": [],
      "exprs": [
        {
          "kind": "expr",
          "code": "portal",
          "frame": "root"
        },
        {
          "kind": "expr",
          "code": "a",
          "frame": "root"
        }
      ],
      "diags": []
    },
    "actual": {
      "frames": [
        {
          "label": "root",
          "parent": null,
          "kind": "root",
          "overlay": null,
          "origin": null
        }
      ],
      "locals": [],
      "exprs": [
        {
          "kind": "expr",
          "frame": "root",
          "code": "\"portal\""
        },
        {
          "kind": "expr",
          "frame": "root",
          "code": "a"
        }
      ],
      "diags": []
    },
    "diff": {
      "missingFrames": [],
      "extraFrames": [],
      "missingLocals": [],
      "extraLocals": [],
      "missingExprs": [
        "expr|root|portal"
      ],
      "extraExprs": [
        "expr|root|\"portal\""
      ],
      "missingDiags": [],
      "extraDiags": []
    }
  },
  {
    "file": "bind-basic.json",
    "name": "B-10 controller chain if → with → portal",
    "markup": "<div if.bind=\"c\" with.bind=\"ctx\" portal><b title.bind=\"t\"></b></div>",
    "expected": {
      "frames": [
        {
          "label": "root",
          "parent": null,
          "kind": "root",
          "overlay": null,
          "origin": null
        },
        {
          "label": "overlay:valueOverlay@1",
          "parent": "root",
          "kind": "overlay",
          "overlay": "value",
          "origin": "valueOverlay"
        }
      ],
      "locals": [],
      "exprs": [
        {
          "kind": "expr",
          "frame": "root",
          "code": "c"
        },
        {
          "kind": "expr",
          "frame": "root",
          "code": "ctx"
        },
        {
          "kind": "expr",
          "frame": "overlay:valueOverlay@1",
          "code": "portal"
        },
        {
          "kind": "expr",
          "frame": "overlay:valueOverlay@1",
          "code": "t"
        }
      ],
      "diags": []
    },
    "actual": {
      "frames": [
        {
          "label": "root",
          "parent": null,
          "kind": "root",
          "overlay": null,
          "origin": null
        },
        {
          "label": "overlay:valueOverlay@1",
          "parent": "root",
          "kind": "overlay",
          "overlay": "value",
          "origin": "valueOverlay"
        }
      ],
      "locals": [],
      "exprs": [
        {
          "kind": "expr",
          "frame": "root",
          "code": "c"
        },
        {
          "kind": "expr",
          "frame": "root",
          "code": "ctx"
        },
        {
          "kind": "expr",
          "frame": "overlay:valueOverlay@1",
          "code": "\"portal\""
        },
        {
          "kind": "expr",
          "frame": "overlay:valueOverlay@1",
          "code": "t"
        }
      ],
      "diags": []
    },
    "diff": {
      "missingFrames": [],
      "extraFrames": [],
      "missingLocals": [],
      "extraLocals": [],
      "missingExprs": [
        "expr|overlay:valueOverlay@1|portal"
      ],
      "extraExprs": [
        "expr|overlay:valueOverlay@1|\"portal\""
      ],
      "missingDiags": [],
      "extraDiags": []
    }
  },
  {
    "file": "bind-switch-portal-if.json",
    "name": "SP-03 portal inside with reuses with overlay",
    "markup": "<div with.bind=\"ctx\"><section portal><i>${z}</i></section></div>",
    "expected": {
      "frames": [
        {
          "label": "root",
          "parent": null,
          "kind": "root",
          "overlay": null,
          "origin": null
        },
        {
          "label": "overlay:valueOverlay@1",
          "parent": "root",
          "kind": "overlay",
          "overlay": "value",
          "origin": "valueOverlay"
        }
      ],
      "locals": [],
      "exprs": [
        {
          "kind": "expr",
          "code": "ctx",
          "frame": "root"
        },
        {
          "kind": "expr",
          "code": "portal",
          "frame": "overlay:valueOverlay@1"
        },
        {
          "kind": "expr",
          "code": "z",
          "frame": "overlay:valueOverlay@1"
        }
      ],
      "diags": []
    },
    "actual": {
      "frames": [
        {
          "label": "root",
          "parent": null,
          "kind": "root",
          "overlay": null,
          "origin": null
        },
        {
          "label": "overlay:valueOverlay@1",
          "parent": "root",
          "kind": "overlay",
          "overlay": "value",
          "origin": "valueOverlay"
        }
      ],
      "locals": [],
      "exprs": [
        {
          "kind": "expr",
          "frame": "root",
          "code": "ctx"
        },
        {
          "kind": "expr",
          "frame": "overlay:valueOverlay@1",
          "code": "\"portal\""
        },
        {
          "kind": "expr",
          "frame": "overlay:valueOverlay@1",
          "code": "z"
        }
      ],
      "diags": []
    },
    "diff": {
      "missingFrames": [],
      "extraFrames": [],
      "missingLocals": [],
      "extraLocals": [],
      "missingExprs": [
        "expr|overlay:valueOverlay@1|portal"
      ],
      "extraExprs": [
        "expr|overlay:valueOverlay@1|\"portal\""
      ],
      "missingDiags": [],
      "extraDiags": []
    }
  }
]